<lccdd xmlns:compact="http://www.lcsim.org/schemas/compact/1.0"
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xs:noNamespaceSchemaLocation="http://www.lcsim.org/schemas/compact/1.0/compact.xsd">

  <global detectorName="ECALe_luxe_v2" />


  <info name="ECALe_luxe_v2"
      title="ECALe_luxe_v2"
      author="J.P. Marquez, A. Irles, S. Huang"
      url="none"
      status="development"
      version="$Id$">
    <comment>The compact File for LUXE ECALe-NPOD</comment>
  </info>

  <includes>
    <comment>Additional design specific material definitions</comment>
    <gdmlFile ref="../elements.xml"/> <!-- /afs/desy.de/project/ilcsoft/sw/x86_64_gcc82_centos7/v02-02-03/lcgeo/v00-16-07/ILD/compact/ILD_o1_v05/elements.xml-->
    <gdmlFile ref="../materials.xml"/> <!-- "/afs/desy.de/project/ilcsoft/sw/x86_64_gcc82_centos7/v02-02-03/lcgeo/v00-16-07/ILD/compact/ILD_o1_v05/materials.xml -->
    <gdmlFile ref="../Materials_v1.xml" />
    <gdmlFile ref="../extra_materials.xml" />
  </includes>

  <define>
    <!-- world -->
    <constant name="world_side" value="10*m" />
    <constant name="world_x" value="world_side" />
    <constant name="world_y" value="world_side" />
    <constant name="world_z" value="world_side" />

    <constant name="tracker_region_rmax" value="0*mm" />
    <constant name="tracker_region_zmax" value="0*mm" />

  </define>


  <limits>
    <limitset name="cal_limits">
      <limit name="step_length_max" particles="*" value="5.0" unit="mm" />
    </limitset>
  </limits>

  <define>
    <include ref="../ECAL_commondefs.xml" />
    <include ref="../ECAL_commondisp.xml" />
    <!--constant name="total_preshower_estimation" value="1.443"/-->
  </define>

  <readouts>
    <readout name="SiEcalCollection">
      <!--We are making a very simple segmentation: one single tile that takes the full surface of every layer "/-->
      <segmentation type="TiledLayerGridXY"
          grid_size_x="Ecal_dim_x*2"
          grid_size_y="Ecal_dim_y*2"
          offset_x="-(Ecal_dim_x)/2.0"
          offset_y="-(Ecal_dim_y)/2.0" />
      <id>system:8,layer:8,x:16,y:16,slice:8</id>
    </readout>
  </readouts>
  <detectors>
    <detector name="ECALe_luxe" type="LUXEEcal" vis="EcalVis" id="3" readout="SiEcalCollection" insideTrackingVolume="false">
      <dimensions
          x="Ecal_dim_x"
          y="Ecal_dim_y"
          z="Ecal_dim_z_10mmgap" />
      <type_flags type="1" />
      <envelope vis="EcalVis">
        <shape type="Box"
            dx="Ecal_dim_x/2.0 + env_safety"
            dy="Ecal_dim_y/2.0 + env_safety"
            dz="Ecal_dim_z_10mmgap/2.0 + env_safety"
            material="Air" />
        <rotation x="0" y="0" z="0" />
        <position x="0" y="0" z="14.25" />
      </envelope>


      <layer repeat="15" vis="EcalVis">
        <!-- the aluminum cover was used in the TB2022-06 but it can be removed! , so we remove it here-->
        <!--slice material = "Air"          thickness = "48.44*mm"   vis="Invisible"/--><!-- Do we need air in front of the detector? how much? for the moment, we ignore it-->
        <slice material="TungstenDens1910"  thickness="2*Ecal_WThickness" vis="TungstenVis" /> <!-- 2x2.1mm of tungsten in each layer-->
        <slice material="CarbonFiber"       thickness="Ecal_CFThickness"  vis="AirVis" staves="true">
          <stave id="0"   x_offset="-134.55*mm" y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="CFVis" />
          <stave id="1"   x_offset="-44.85*mm"  y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="CFVis" />
          <stave id="2"   x_offset="44.85*mm"   y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="CFVis" />
          <stave id="3"   x_offset="134.55*mm"  y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="CFVis" />
          <stave id="4"   x_offset="-134.55*mm" y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="CFVis" />
          <stave id="5"   x_offset="-44.85*mm"  y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="CFVis" />
          <stave id="6"   x_offset="44.85*mm"   y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="CFVis" />
          <stave id="7"   x_offset="134.55*mm"  y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="CFVis" />
        </slice>
        <slice material="Cu"                thickness="Ecal_KaptonThickness" vis="AirVis" staves="true">
          <stave id="0"   x_offset="-134.55*mm" y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="CuVis" />
          <stave id="1"   x_offset="-44.85*mm"  y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="CuVis" />
          <stave id="2"   x_offset="44.85*mm"   y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="CuVis" />
          <stave id="3"   x_offset="134.55*mm"  y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="CuVis" />
          <stave id="4"   x_offset="-134.55*mm" y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="CuVis" />
          <stave id="5"   x_offset="-44.85*mm"  y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="CuVis" />
          <stave id="6"   x_offset="44.85*mm"   y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="CuVis" />
          <stave id="7"   x_offset="134.55*mm"  y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="CuVis" />
        </slice>
        <slice material="Air"               thickness="Ecal_GlueThickness_kap" vis="AirVis" />
        <slice material="Si"                thickness="Ecal_WaferThickness500" vis="AirVis" staves="true" sensitive="yes">
          <stave id="0"   x_offset="-134.55*mm" y_offset="-44.85*mm"  dx="88.48*mm" dy="88.48*mm"   vis="SiVis" />
          <stave id="1"   x_offset="-44.85*mm"  y_offset="-44.85*mm"  dx="88.48*mm" dy="88.48*mm"   vis="SiVis" />
          <stave id="2"   x_offset="44.85*mm"   y_offset="-44.85*mm"  dx="88.48*mm" dy="88.48*mm"   vis="SiVis" />
          <stave id="3"   x_offset="134.55*mm"  y_offset="-44.85*mm"  dx="88.48*mm" dy="88.48*mm"   vis="SiVis" />
          <stave id="4"   x_offset="-134.55*mm" y_offset="44.85*mm"   dx="88.48*mm" dy="88.48*mm"   vis="SiVis" />
          <stave id="5"   x_offset="-44.85*mm"  y_offset="44.85*mm"   dx="88.48*mm" dy="88.48*mm"   vis="SiVis" />
          <stave id="6"   x_offset="44.85*mm"   y_offset="44.85*mm"   dx="88.48*mm" dy="88.48*mm"   vis="SiVis" />
          <stave id="7"   x_offset="134.55*mm"  y_offset="44.85*mm"   dx="88.48*mm" dy="88.48*mm"   vis="SiVis" />
        </slice>
        <slice material="Air"               thickness="Ecal_GlueThickness_pcb" vis="AirVis" />
        <!--slice material = "Cu"           thickness = "Ecal_KaptonThickness" vis="CuVis" /--> <!-- this part is not existing-->
        <slice material="PCB"               thickness="Ecal_PcbThickness"      vis="AirVis" staves="true">
          <stave id="0"   x_offset="-134.55*mm" y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="PCBVis" />
          <stave id="1"   x_offset="-44.85*mm"  y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="PCBVis" />
          <stave id="2"   x_offset="44.85*mm"   y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="PCBVis" />
          <stave id="3"   x_offset="134.55*mm"  y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="PCBVis" />
          <stave id="4"   x_offset="-134.55*mm" y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="PCBVis" />
          <stave id="5"   x_offset="-44.85*mm"  y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="PCBVis" />
          <stave id="6"   x_offset="44.85*mm"   y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="PCBVis" />
          <stave id="7"   x_offset="134.55*mm"  y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="PCBVis" />
        </slice>
        <slice material="PCB"               thickness="Ecal_ChipThickness" vis="AirVis" staves="true">
          <stave id="0"   x_offset="-134.55*mm" y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="AirVis" />
          <stave id="1"   x_offset="-44.85*mm"  y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="AirVis" />
          <stave id="2"   x_offset="44.85*mm"   y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="AirVis" />
          <stave id="3"   x_offset="134.55*mm"  y_offset="-44.85*mm"  dx="89.7*mm" dy="89.7*mm"   vis="AirVis" />
          <stave id="4"   x_offset="-134.55*mm" y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="AirVis" />
          <stave id="5"   x_offset="-44.85*mm"  y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="AirVis" />
          <stave id="6"   x_offset="44.85*mm"   y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="AirVis" />
          <stave id="7"   x_offset="134.55*mm"  y_offset="44.85*mm"   dx="89.7*mm" dy="89.7*mm"   vis="AirVis" />
        </slice>
        <slice material="Air"               thickness="Ecal_w_slab_gap500_10mmgap" vis="AirVis" />
      </layer>

    </detector>
  </detectors>
</lccdd>